<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Happy New Year ðŸŽ†</title>
<style>
  :root{
    --bg1:#0f2027; --bg2:#203a43; --bg3:#2c5364;
    --card: rgba(255,255,255,.08);
    --stroke: rgba(255,255,255,.14);
    --txt: rgba(255,255,255,.94);
    --muted: rgba(255,255,255,.74);
    --gold:#ffd36a; --pink:#ff5fd7; --cyan:#50e3ff;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    min-height:100svh;
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
    font-family: "Segoe UI", system-ui, -apple-system, Arial, sans-serif;
    color:#fff;
    padding: env(safe-area-inset-top) 14px env(safe-area-inset-bottom);
    background:
      radial-gradient(1200px 800px at 20% 10%, rgba(80,227,255,.16), transparent 55%),
      radial-gradient(1000px 700px at 90% 20%, rgba(255,95,215,.14), transparent 55%),
      linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
  }

  /* floating orbs */
  .orb{
    position:absolute; width:420px; height:420px; border-radius:50%;
    filter: blur(36px); opacity:.18; mix-blend-mode: screen;
    animation: float 10s ease-in-out infinite;
    pointer-events:none;
  }
  .orb.one{background: radial-gradient(circle at 30% 30%, var(--cyan), transparent 60%); left:-140px; top:40px;}
  .orb.two{background: radial-gradient(circle at 30% 30%, var(--pink), transparent 60%); right:-160px; top:120px; animation-delay:-3s;}
  .orb.three{background: radial-gradient(circle at 30% 30%, var(--gold), transparent 60%); left:22%; bottom:-200px; animation-delay:-6s;}
  @keyframes float{0%,100%{transform:translate3d(0,0,0) scale(1)}50%{transform:translate3d(35px,-25px,0) scale(1.06)}}

  .stars{
    position:absolute; inset:0; pointer-events:none; opacity:.85;
    background:
      radial-gradient(2px 2px at 12% 18%, rgba(255,255,255,.75), transparent 60%),
      radial-gradient(1.5px 1.5px at 28% 66%, rgba(255,255,255,.55), transparent 60%),
      radial-gradient(2.2px 2.2px at 74% 28%, rgba(255,255,255,.65), transparent 60%),
      radial-gradient(1.4px 1.4px at 84% 62%, rgba(255,255,255,.55), transparent 60%),
      radial-gradient(1.8px 1.8px at 44% 22%, rgba(255,255,255,.55), transparent 60%),
      radial-gradient(1.2px 1.2px at 56% 78%, rgba(255,255,255,.45), transparent 60%);
    animation: twinkle 3.8s ease-in-out infinite;
  }
  @keyframes twinkle{0%,100%{opacity:.55; transform:translateY(0)}50%{opacity:.9; transform:translateY(-2px)}}

  .card{
    position:relative;
    width:min(560px, 96vw);
    text-align:center;
    padding:28px 20px 22px;
    border-radius:18px;
    background: var(--card);
    backdrop-filter: blur(10px);
    box-shadow: 0 25px 60px rgba(0,0,0,.45);
    border:1px solid var(--stroke);
    opacity:0;
    transform: translateY(16px) scale(.98);
    animation: cardIn 1.05s cubic-bezier(.2,.9,.2,1) forwards;
  }
  @keyframes cardIn{to{opacity:1; transform:translateY(0) scale(1)}}

  .card::before{
    content:""; position:absolute; inset:-2px; border-radius:inherit;
    background: linear-gradient(120deg,
      transparent 0%,
      rgba(255,255,255,0.12) 35%,
      rgba(255,211,106,0.18) 50%,
      rgba(255,255,255,0.12) 65%,
      transparent 100%);
    transform: translateX(-120%) skewX(-12deg);
    animation: shine 3.8s ease-in-out infinite;
    pointer-events:none;
    mix-blend-mode: screen;
  }
  @keyframes shine{
    0%,38%{transform:translateX(-120%) skewX(-12deg); opacity:0}
    50%{opacity:.7}
    74%{transform:translateX(120%) skewX(-12deg); opacity:0}
    100%{transform:translateX(120%) skewX(-12deg); opacity:0}
  }

  h1{
    margin:0 0 10px;
    font-size: clamp(22px, 4.4vw, 34px);
    letter-spacing:.3px;
    opacity:0; transform: translateY(-14px);
    animation: titleDrop .85s ease forwards .15s;
    text-shadow: 0 0 18px rgba(255,211,106,.22);
  }
  @keyframes titleDrop{to{opacity:1; transform:translateY(0)}}

  .stepTag{
    margin: 0 0 8px;
    font-size:.9rem;
    color: rgba(255,255,255,.82);
    opacity:0; transform: translateY(8px);
    animation: fadeUp .75s ease forwards .32s;
  }
  @keyframes fadeUp{to{opacity:1; transform:translateY(0)}}

  .question{
    margin: 10px 0 10px;
    font-size: clamp(18px, 5vw, 24px);
    line-height: 1.45;
    color: var(--txt);
    opacity:0;
    transform: translateY(10px);
  }
  .question.pop{
    animation: qPop .55s cubic-bezier(.2,1.15,.25,1) forwards;
  }
  @keyframes qPop{
    0%{opacity:0; transform: translateY(10px) scale(.98); filter: blur(1px)}
    70%{opacity:1; transform: translateY(0) scale(1.03); filter: blur(0)}
    100%{opacity:1; transform: translateY(0) scale(1)}
  }

  .subline{
    margin: 0 0 14px;
    color: var(--muted);
    font-size: .98rem;
    min-height: 22px;
    opacity:0;
    transform: translateY(8px);
  }
  .subline.show{ animation: fadeUp .55s ease forwards; }

  .btnRow{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:12px;
    margin-top: 10px;
  }
  button{
    border:none;
    cursor:pointer;
    padding: 14px 14px;
    border-radius: 999px;
    font-weight: 800;
    letter-spacing:.2px;
    transition: transform .15s ease, filter .15s ease, box-shadow .15s ease;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
    min-height: 48px;
  }
  .btnPrimary{
    color:#091018;
    background: linear-gradient(135deg, var(--gold), #fff);
    box-shadow: 0 12px 26px rgba(255,211,106,.22);
  }
  .btnGhost{
    color:#fff;
    background: rgba(255,255,255,.12);
    border:1px solid rgba(255,255,255,.18);
    box-shadow:none;
  }
  button:active{transform: translateY(1px) scale(.99)}

  /* On small screens make buttons full width stacked */
  @media (max-width: 420px){
    .card{padding: 24px 16px 18px; border-radius:16px;}
    .btnRow{grid-template-columns: 1fr;}
  }

  /* Celebration overlay */
  .overlay{
    position:absolute; inset:0;
    pointer-events:none;
    opacity:0;
    transition: opacity .22s ease;
  }
  .overlay.on{opacity:1}
  canvas{position:absolute; inset:0; width:100%; height:100%; pointer-events:none}

  .big{
    position:absolute; left:50%; top:50%;
    transform: translate(-50%,-50%) scale(.8);
    text-align:center;
    opacity:0;
    width:min(900px, 94vw);
    padding: 18px 14px;
  }
  .big.on{
    opacity:1;
    animation: bigPop 1.15s cubic-bezier(.15,1.15,.2,1) forwards;
  }
  @keyframes bigPop{
    0%{transform:translate(-50%,-50%) scale(.72); filter:blur(2px)}
    55%{transform:translate(-50%,-50%) scale(1.06); filter:blur(0)}
    100%{transform:translate(-50%,-50%) scale(1)}
  }
  .big h2{
    margin:0;
    font-size: clamp(34px, 9vw, 72px);
    line-height:1.05;
    text-shadow: 0 0 22px rgba(80,227,255,.15), 0 0 28px rgba(255,95,215,.12);
  }
  .big p{
    margin:10px 0 0;
    font-size: clamp(14px, 4vw, 18px);
    opacity:.9;
  }

  /* Balloons */
  .balloons{ position:absolute; inset:0; pointer-events:none; overflow:hidden; }
  .balloon{
    position:absolute;
    width:44px; height:56px;
    border-radius: 50% 50% 48% 48%;
    opacity:.85;
    filter: drop-shadow(0 10px 18px rgba(0,0,0,.25));
    transform: translateY(110vh);
    animation: rise 7.5s linear infinite;
  }
  .balloon::after{
    content:"";
    position:absolute;
    left:50%; top: 54px;
    width:2px; height:60px;
    background: rgba(255,255,255,.35);
    transform: translateX(-50%);
  }
  @keyframes rise{
    0%{transform: translateY(110vh) translateX(0) rotate(0deg)}
    100%{transform: translateY(-140px) translateX(30px) rotate(4deg)}
  }
</style>
</head>
<body>
  <div class="orb one"></div>
  <div class="orb two"></div>
  <div class="orb three"></div>
  <div class="stars"></div>

  <div class="card" id="card" role="region" aria-label="New Year flow">
    <h1>âœ¨ Happy New Year âœ¨</h1>
    <div class="stepTag" id="stepTag">Step 1/4</div>

    <div class="question pop" id="question"></div>
    <div class="subline" id="subline"></div>

    <div class="btnRow" id="btnRow"></div>
  </div>

  <div class="overlay" id="overlay">
    <canvas id="fireworks"></canvas>
    <canvas id="confetti"></canvas>
    <div class="balloons" id="balloons"></div>

    <div class="big" id="big">
      <h2>ðŸŽ† HAPPY NEW YEAR ðŸŽ†</h2>
      <p>Party mode ON ðŸ¥³ðŸŽˆðŸš€</p>
      <p style="opacity:.72; margin-top:8px;">(Press ESC to stop)</p>
    </div>
  </div>

<script>
/* ---------------------------
   Updates requested:
   âœ… Phone-friendly layout (stack buttons on small screens)
   âœ… Removed extra "bakar" text / tips
   âœ… Step 3: NO -> back to Step 1
   âœ… Every step: if user clicks NO, ask ONE more time (retry)
----------------------------*/

const stepTag = document.getElementById("stepTag");
const questionEl = document.getElementById("question");
const sublineEl = document.getElementById("subline");
const btnRow = document.getElementById("btnRow");

const overlay = document.getElementById("overlay");
const big = document.getElementById("big");
const balloonsWrap = document.getElementById("balloons");

const fwCanvas = document.getElementById("fireworks");
const cfCanvas = document.getElementById("confetti");
const fwCtx = fwCanvas.getContext("2d");
const cfCtx = cfCanvas.getContext("2d");

let step = 1;
let celebrating = false;
let burstTimer = null;
let balloonTimer = null;

// per-step retry counters (NO clicked once => ask again, second time => do action)
const noRetry = { 1:0, 2:0, 3:0, 4:0 };

// ---- SOUND (WebAudio) ----
let audioCtx;
function ensureAudio(){
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  if (audioCtx.state === "suspended") audioCtx.resume();
}
function popSound(timeOffset=0){
  ensureAudio();
  const t0 = audioCtx.currentTime + timeOffset;
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = "triangle";
  o.frequency.setValueAtTime(160, t0);
  o.frequency.exponentialRampToValueAtTime(520, t0 + 0.03);
  g.gain.setValueAtTime(0.0001, t0);
  g.gain.exponentialRampToValueAtTime(0.22, t0 + 0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.12);
  o.connect(g).connect(audioCtx.destination);
  o.start(t0); o.stop(t0 + 0.14);
}
function crackleNoise(duration=0.22, timeOffset=0){
  ensureAudio();
  const t0 = audioCtx.currentTime + timeOffset;
  const bufferSize = Math.max(1, Math.floor(audioCtx.sampleRate * duration));
  const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
  const data = buffer.getChannelData(0);
  for (let i=0;i<bufferSize;i++){
    data[i] = (Math.random()*2 - 1) * (Math.random() < 0.06 ? 1 : 0.18);
  }
  const src = audioCtx.createBufferSource(); src.buffer = buffer;
  const g = audioCtx.createGain();
  g.gain.setValueAtTime(0.0001, t0);
  g.gain.exponentialRampToValueAtTime(0.26, t0 + 0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, t0 + duration);
  const f = audioCtx.createBiquadFilter();
  f.type = "highpass"; f.frequency.value = 700;
  src.connect(f).connect(g).connect(audioCtx.destination);
  src.start(t0); src.stop(t0 + duration);
}
function happyNewYearJingle(){
  ensureAudio();
  const now = audioCtx.currentTime;
  const notes = [523.25, 659.25, 783.99]; // C5, E5, G5
  notes.forEach((freq, i) => {
    const t0 = now + i*0.12;
    const o = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    o.type = "sine";
    o.frequency.setValueAtTime(freq, t0);
    g.gain.setValueAtTime(0.0001, t0);
    g.gain.exponentialRampToValueAtTime(0.20, t0 + 0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, t0 + 0.18);
    o.connect(g).connect(audioCtx.destination);
    o.start(t0); o.stop(t0 + 0.22);
  });
}
function celebrationSoundBurst(){
  happyNewYearJingle();
  popSound(0.08); crackleNoise(0.22, 0.10);
  popSound(0.20); crackleNoise(0.18, 0.22);
  popSound(0.34); crackleNoise(0.24, 0.36);
  popSound(0.50); crackleNoise(0.20, 0.52);
}

// ---- CANVAS RESIZE ----
function resize(){
  const dpr = devicePixelRatio || 1;
  fwCanvas.width = cfCanvas.width = Math.floor(window.innerWidth * dpr);
  fwCanvas.height = cfCanvas.height = Math.floor(window.innerHeight * dpr);
  fwCtx.setTransform(dpr,0,0,dpr,0,0);
  cfCtx.setTransform(dpr,0,0,dpr,0,0);
}
window.addEventListener("resize", resize);
resize();

// ---- Fireworks + Rockets ----
const sparks = [];
const rockets = [];

function burst(x, y){
  const count = 70 + Math.floor(Math.random()*45);
  const hueBase = Math.random()*360;
  for (let i=0;i<count;i++){
    const a = (Math.PI*2) * (i / count);
    const speed = 2.2 + Math.random()*4.6;
    sparks.push({
      x,y,
      vx: Math.cos(a)*speed*(0.6+Math.random()*0.6),
      vy: Math.sin(a)*speed*(0.6+Math.random()*0.6),
      life: 1,
      decay: 0.012 + Math.random()*0.018,
      size: 1 + Math.random()*2,
      hue: (hueBase + (Math.random()*60 - 30)) % 360
    });
  }
}

function launchRocket(){
  const x = 80 + Math.random()*(window.innerWidth-160);
  const y = window.innerHeight + 30;
  rockets.push({
    x, y,
    vx: (Math.random()*2 - 1) * 0.6,
    vy: -(6.5 + Math.random()*3.5),
    hue: Math.random()*360,
    trail: [],
    explodeAt: 120 + Math.random()*(window.innerHeight*0.35)
  });
}

function fireworksLoop(){
  if (!celebrating) return;

  fwCtx.fillStyle = "rgba(0,0,0,0.18)";
  fwCtx.fillRect(0,0,window.innerWidth,window.innerHeight);

  fwCtx.globalCompositeOperation = "lighter";

  for (let i=rockets.length-1;i>=0;i--){
    const r = rockets[i];
    r.x += r.vx; r.y += r.vy;
    r.vy *= 0.995;

    r.trail.push({x:r.x, y:r.y});
    if (r.trail.length > 18) r.trail.shift();

    for (let t=0;t<r.trail.length;t++){
      const p = r.trail[t];
      fwCtx.fillStyle = `hsla(${r.hue}, 100%, 65%, ${t/r.trail.length})`;
      fwCtx.fillRect(p.x, p.y, 2, 2);
    }

    fwCtx.fillStyle = `hsla(${r.hue}, 100%, 70%, 1)`;
    fwCtx.beginPath();
    fwCtx.arc(r.x, r.y, 2.4, 0, Math.PI*2);
    fwCtx.fill();

    if (r.y < r.explodeAt){
      burst(r.x, r.y);
      popSound(0);
      if (Math.random()<0.6) crackleNoise(0.18, 0);
      rockets.splice(i,1);
    }
  }

  for (let i=sparks.length-1;i>=0;i--){
    const s = sparks[i];
    s.x += s.vx; s.y += s.vy;
    s.vy += 0.035;
    s.vx *= 0.992; s.vy *= 0.992;
    s.life -= s.decay;

    const a = Math.max(0, s.life);
    fwCtx.fillStyle = `hsla(${s.hue}, 100%, 65%, ${a})`;
    fwCtx.beginPath();
    fwCtx.arc(s.x, s.y, s.size, 0, Math.PI*2);
    fwCtx.fill();

    if (s.life <= 0) sparks.splice(i,1);
  }

  fwCtx.globalCompositeOperation = "source-over";
  requestAnimationFrame(fireworksLoop);
}

// ---- Confetti ----
const confetti = [];
function spawnConfetti(amount=140){
  for (let i=0;i<amount;i++){
    confetti.push({
      x: Math.random()*window.innerWidth,
      y: -20 - Math.random()*window.innerHeight*0.2,
      vx: (Math.random()*2 - 1) * 1.2,
      vy: 2.0 + Math.random()*3.2,
      w: 5 + Math.random()*8,
      h: 6 + Math.random()*10,
      rot: Math.random()*Math.PI*2,
      vr: (Math.random()*2 - 1) * 0.08,
      life: 1,
      decay: 0.002 + Math.random()*0.004,
      hue: Math.random()*360
    });
  }
}
function confettiLoop(){
  if (!celebrating) return;

  cfCtx.clearRect(0,0,window.innerWidth,window.innerHeight);

  for (let i=confetti.length-1;i>=0;i--){
    const c = confetti[i];
    c.x += c.vx; c.y += c.vy;
    c.rot += c.vr;
    c.x += Math.sin(c.y*0.01)*0.35;
    c.vx *= 0.995; c.vy *= 0.998;
    c.life -= c.decay;

    const a = Math.max(0, c.life);
    cfCtx.save();
    cfCtx.translate(c.x, c.y);
    cfCtx.rotate(c.rot);
    cfCtx.fillStyle = `hsla(${c.hue}, 95%, 60%, ${a})`;
    cfCtx.fillRect(-c.w/2, -c.h/2, c.w, c.h);
    cfCtx.restore();

    if (c.y > window.innerHeight+70 || c.life <= 0) confetti.splice(i,1);
  }
  requestAnimationFrame(confettiLoop);
}

// ---- Balloons ----
function spawnBalloon(){
  const b = document.createElement("div");
  b.className = "balloon";
  b.style.left = (Math.random()*(window.innerWidth-60)) + "px";
  const hue = Math.floor(Math.random()*360);
  b.style.background = `radial-gradient(circle at 30% 30%, hsla(${hue},100%,70%,.95), hsla(${hue},100%,45%,.9))`;
  b.style.animationDuration = (6.5 + Math.random()*4.5) + "s";
  b.style.opacity = (0.68 + Math.random()*0.25).toFixed(2);
  balloonsWrap.appendChild(b);
  setTimeout(()=>b.remove(), 11000);
}
function startBalloons(){
  spawnBalloon();
  balloonTimer = setInterval(spawnBalloon, 520);
}
function stopBalloons(){
  if (balloonTimer) clearInterval(balloonTimer);
  balloonTimer = null;
  balloonsWrap.innerHTML = "";
}

// ---- UI helpers ----
function setQuestion(stepNum, qText, buttons){
  stepTag.textContent = `Step ${stepNum}/4`;
  questionEl.classList.remove("pop");
  sublineEl.classList.remove("show");
  void questionEl.offsetWidth;
  questionEl.textContent = qText;
  questionEl.classList.add("pop");

  btnRow.innerHTML = "";
  buttons.forEach(b=>{
    const btn = document.createElement("button");
    btn.textContent = b.label;
    btn.className = b.primary ? "btnPrimary" : "btnGhost";
    btn.addEventListener("click", () => {
      try{ popSound(0); }catch(e){}
      b.onClick();
    });
    btnRow.appendChild(btn);
  });
}

function showSubline(text, waitMs=850){
  sublineEl.textContent = text;
  sublineEl.classList.add("show");
  return new Promise(res => setTimeout(res, waitMs));
}

// Generic NO handler that retries once
async function handleNo(stepNum, retryMsg, afterSecondNo){
  if (noRetry[stepNum] === 0){
    noRetry[stepNum] = 1;
    await showSubline("Ek baar aur? ðŸ˜„", 650);
    // re-render same step again
    renderStep(stepNum);
  } else {
    noRetry[stepNum] = 0; // reset for next time
    if (retryMsg) await showSubline(retryMsg, 850);
    afterSecondNo();
  }
}

// ---- Steps ----
function renderStep(n){
  if (n === 1) goStep1();
  if (n === 2) goStep2();
  if (n === 3) goStep3();
  if (n === 4) goStep4();
}

function goStep1(){
  step = 1;
  setQuestion(1, "Sound high hai? ðŸ”Š", [
    { label:"HAAN", primary:true, onClick: () => { ensureAudio(); noRetry[1]=0; goStep2(); } },
    { label:"NAHI", primary:false, onClick: () => handleNo(
        1,
        "Kar na phir ðŸ˜ðŸ”Š",
        () => goStep2()
      )
    }
  ]);
}

function goStep2(){
  step = 2;
  setQuestion(2, "Kuch bhool raha hai? ðŸ¤”", [
    { label:"HAAN", primary:true, onClick: () => { noRetry[2]=0; goStep3(); } },
    { label:"NAHI", primary:false, onClick: () => handleNo(
        2,
        "Yaad karo phir ðŸ˜‚ðŸ§ ",
        () => goStep3()
      )
    }
  ]);
}

function goStep3(){
  step = 3;
  setQuestion(3, "Hume bhool gaya kya? ðŸ˜’", [
    { label:"HAAN", primary:true, onClick: () => { noRetry[3]=0; goStep4(); } },
    { label:"NAHI", primary:false, onClick: () => handleNo(
        3,
        "Phir se start kar ðŸ˜œðŸ”",
        () => goStep1() // requirement: Step 3 NO -> Step 1
      )
    }
  ]);
}

function goStep4(){
  step = 4;
  setQuestion(4, "Okâ€¦ ready for party? ðŸ¥³", [
    { label:"PARTY", primary:true, onClick: () => { noRetry[4]=0; startCelebration(); } },
    { label:"NAHI", primary:false, onClick: () => handleNo(
        4,
        "Chal na yaar ðŸ˜ðŸ»",
        () => renderStep(4) // stay on step 4
      )
    }
  ]);
}

// ---- Celebration ----
function startCelebration(){
  if (celebrating) return;
  celebrating = true;

  overlay.classList.add("on");
  big.classList.add("on");

  celebrationSoundBurst();

  fwCtx.clearRect(0,0,window.innerWidth,window.innerHeight);
  cfCtx.clearRect(0,0,window.innerWidth,window.innerHeight);

  spawnConfetti(240);
  fireworksLoop();
  confettiLoop();
  startBalloons();

  const cx = window.innerWidth/2;
  const cy = window.innerHeight/2;
  burst(cx, cy - 90);
  burst(cx - 170, cy - 40);
  burst(cx + 170, cy - 40);

  for (let i=0;i<7;i++) launchRocket();

  burstTimer = setInterval(() => {
    if (Math.random() < 0.65) launchRocket();
    if (Math.random() < 0.35) crackleNoise(0.18, 0);
    if (Math.random() < 0.22) spawnConfetti(60);
  }, 520);

  overlay.style.pointerEvents = "auto";
  overlay.addEventListener("click", overlayClickBurst);
}

function overlayClickBurst(e){
  if (!celebrating) return;
  burst(e.clientX, e.clientY);
  popSound(0);
  if (Math.random()<0.7) crackleNoise(0.18,0);
}

function stopCelebration(){
  celebrating = false;
  overlay.classList.remove("on");
  big.classList.remove("on");
  overlay.style.pointerEvents = "none";

  if (burstTimer) clearInterval(burstTimer);
  burstTimer = null;

  stopBalloons();
  sparks.length = 0;
  rockets.length = 0;
  confetti.length = 0;

  fwCtx.clearRect(0,0,window.innerWidth,window.innerHeight);
  cfCtx.clearRect(0,0,window.innerWidth,window.innerHeight);

  overlay.removeEventListener("click", overlayClickBurst);
}

window.addEventListener("keydown", (e) => {
  if (e.key === "Escape" && celebrating) stopCelebration();
});

// Init
goStep1();
</script>
</body>
</html>
